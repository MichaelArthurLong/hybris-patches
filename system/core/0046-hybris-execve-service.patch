From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Franz-Josef Haider <franz.haider@jolla.com>
Date: Mon, 12 Oct 2020 19:25:00 +0000
Subject: [PATCH] (hybris) execve service

Signed-off-by: Simonas Leleiva <simonas.leleiva@jolla.com>
Change-Id: I2efa4048bc2e4da848a61e24d8ef8b1824a81f06
---
 init/service.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/init/service.cpp b/init/service.cpp
index 06cd20fed7ae1ec62202fa457ce7b5a197893373..3f00d2c9ac2bb19d677fac99cad1ea72a880dec3 100644
--- a/init/service.cpp
+++ b/init/service.cpp
@@ -195,7 +195,6 @@ Result<Success> Service::EnterNamespaces() const {
     return Success();
 }
 
-/*
 static bool ExpandArgsAndExecv(const std::vector<std::string>& args, bool sigstop) {
     std::vector<std::string> expanded_args;
     std::vector<char*> c_strings;
@@ -218,6 +217,7 @@ static bool ExpandArgsAndExecv(const std::vector<std::string>& args, bool sigsto
 }
 
 
+/*
 static bool IsRuntimeApexReady() {
     struct stat buf;
     return stat("/apex/com.android.runtime/", &buf) == 0;
@@ -1071,6 +1071,7 @@ Result<Success> Service::Start() {
             }
         }
 
+#endif
         if (needs_console) {
             setsid();
             OpenConsole();
@@ -1086,7 +1087,6 @@ Result<Success> Service::Start() {
             PLOG(ERROR) << "cannot execve('" << args_[0] << "')";
         }
 
-#endif
         _exit(127);
     }
 
