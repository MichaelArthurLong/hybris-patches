From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Franz-Josef Haider <franz.haider@jolla.com>
Date: Mon, 12 Oct 2020 19:25:00 +0000
Subject: [PATCH] (hybris) execve service

Signed-off-by: Simonas Leleiva <simonas.leleiva@jolla.com>
Change-Id: I2efa4048bc2e4da848a61e24d8ef8b1824a81f06
---
 init/service.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/init/service.cpp b/init/service.cpp
index 344ac727b15f4ad7862ea7c3365dde74005cfdc3..34b969395b14af797beae87b7ee929d060f0fd52 100644
--- a/init/service.cpp
+++ b/init/service.cpp
@@ -106,7 +106,6 @@ static Result<std::string> ComputeContextFromExecutable(const std::string& servi
 }
 */
 
-/*
 static bool ExpandArgsAndExecv(const std::vector<std::string>& args, bool sigstop) {
     std::vector<std::string> expanded_args;
     std::vector<char*> c_strings;
@@ -130,6 +129,7 @@ static bool ExpandArgsAndExecv(const std::vector<std::string>& args, bool sigsto
     return execv(c_strings[0], c_strings.data()) == 0;
 }
 
+/*
 static bool AreRuntimeApexesReady() {
     struct stat buf;
     return stat("/apex/com.android.art/", &buf) == 0 &&
@@ -540,6 +540,7 @@ Result<void> Service::Start() {
         if (task_profiles_.size() > 0 && !SetTaskProfiles(getpid(), task_profiles_)) {
             LOG(ERROR) << "failed to set task profiles";
         }
+#endif
 
         // As requested, set our gid, supplemental gids, uid, context, and
         // priority. Aborts on failure.
@@ -550,7 +551,6 @@ Result<void> Service::Start() {
                         << "'). See the 'Debugging init' section of init's README.md for tips";
         }
 
-#endif
         _exit(127);
     }
 
